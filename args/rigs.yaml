# =============================================================================
# Rigs Configuration - ExoSkull GOTCHA Framework
# =============================================================================
# External API integrations (data sources).
# Each rig syncs data to the ExoSkull data lake.
# =============================================================================

# Default sync behavior
defaults:
  sync_on_connect: true
  retry_on_failure: 3
  backoff_ms: [1000, 5000, 15000]
  store_raw_in_bronze: true

# =============================================================================
# HEALTH RIGS
# =============================================================================

health:
  # ---------------------------------------------------------------------------
  # Google Fit
  # ---------------------------------------------------------------------------
  google-fit:
    name: "Google Fit"
    description: "Steps, activity, heart rate from Google Fit"
    icon: "heart-pulse"
    category: health
    status: active

    oauth:
      provider: google
      scopes:
        - "https://www.googleapis.com/auth/fitness.activity.read"
        - "https://www.googleapis.com/auth/fitness.body.read"
        - "https://www.googleapis.com/auth/fitness.heart_rate.read"
        - "https://www.googleapis.com/auth/fitness.sleep.read"

    api:
      base_url: "https://www.googleapis.com/fitness/v1/users/me"
      rate_limit:
        requests: 1000
        period: day

    sync:
      frequency: hourly
      data_types:
        - steps
        - distance
        - calories
        - heart_rate
        - sleep
        - activity_segments

    bronze_path: "bronze/health/google-fit/"

  # ---------------------------------------------------------------------------
  # Oura Ring
  # ---------------------------------------------------------------------------
  oura:
    name: "Oura Ring"
    description: "Sleep, readiness, activity from Oura Ring"
    icon: "ring"
    category: health
    status: planned

    oauth:
      auth_url: "https://cloud.ouraring.com/oauth/authorize"
      token_url: "https://api.ouraring.com/oauth/token"
      scopes:
        - daily
        - heartrate
        - personal
        - session
        - sleep
        - workout

    api:
      base_url: "https://api.ouraring.com/v2"
      rate_limit:
        requests: 1000
        period: day

    sync:
      frequency: hourly
      data_types:
        - sleep_score
        - sleep_stages
        - readiness_score
        - hrv
        - resting_heart_rate
        - activity_score
        - temperature_deviation

    bronze_path: "bronze/health/oura/"

  # ---------------------------------------------------------------------------
  # Fitbit
  # ---------------------------------------------------------------------------
  fitbit:
    name: "Fitbit"
    description: "Steps, sleep, heart rate from Fitbit"
    icon: "watch"
    category: health
    status: planned

    oauth:
      auth_url: "https://www.fitbit.com/oauth2/authorize"
      token_url: "https://api.fitbit.com/oauth2/token"
      scopes:
        - activity
        - heartrate
        - nutrition
        - profile
        - sleep
        - weight

    api:
      base_url: "https://api.fitbit.com/1"
      rate_limit:
        requests: 150
        period: hour

    sync:
      frequency: hourly
      data_types:
        - steps
        - distance
        - calories
        - heart_rate
        - sleep
        - weight

    bronze_path: "bronze/health/fitbit/"

  # ---------------------------------------------------------------------------
  # Apple Health (via HealthConnect on Android or direct)
  # ---------------------------------------------------------------------------
  health-connect:
    name: "Health Connect"
    description: "Unified health data from Android Health Connect"
    icon: "activity"
    category: health
    status: planned

    api:
      type: local # No OAuth, local Android API
      permissions:
        - STEPS
        - HEART_RATE
        - SLEEP
        - EXERCISE
        - NUTRITION
        - BODY_MEASUREMENTS

    sync:
      frequency: realtime
      data_types:
        - steps
        - heart_rate
        - sleep
        - exercise
        - nutrition
        - weight

    bronze_path: "bronze/health/health-connect/"

# =============================================================================
# PRODUCTIVITY RIGS
# =============================================================================

productivity:
  # ---------------------------------------------------------------------------
  # Google Workspace (Calendar, Drive, Tasks)
  # ---------------------------------------------------------------------------
  google-workspace:
    name: "Google Workspace"
    description: "Calendar, Drive, Gmail, Tasks from Google"
    icon: "calendar"
    category: productivity
    status: active

    oauth:
      provider: google
      scopes:
        - "https://www.googleapis.com/auth/calendar.readonly"
        - "https://www.googleapis.com/auth/calendar.events"
        - "https://www.googleapis.com/auth/drive.readonly"
        - "https://www.googleapis.com/auth/gmail.readonly"
        - "https://www.googleapis.com/auth/tasks.readonly"

    api:
      base_url: "https://www.googleapis.com"
      rate_limit:
        requests: 10000
        period: day

    sync:
      frequency: hourly
      data_types:
        - calendar_events
        - tasks
        - recent_files
        - email_metadata

    bronze_path: "bronze/productivity/google-workspace/"

  # ---------------------------------------------------------------------------
  # Microsoft 365
  # ---------------------------------------------------------------------------
  microsoft-365:
    name: "Microsoft 365"
    description: "Outlook calendar, email, OneDrive"
    icon: "microsoft"
    category: productivity
    status: active

    oauth:
      auth_url: "https://login.microsoftonline.com/common/oauth2/v2.0/authorize"
      token_url: "https://login.microsoftonline.com/common/oauth2/v2.0/token"
      scopes:
        - "Calendars.Read"
        - "Mail.Read"
        - "Files.Read"
        - "Tasks.Read"
        - "offline_access"

    api:
      base_url: "https://graph.microsoft.com/v1.0"
      rate_limit:
        requests: 10000
        period: day

    sync:
      frequency: hourly
      data_types:
        - calendar_events
        - emails_metadata
        - tasks
        - recent_files

    bronze_path: "bronze/productivity/microsoft-365/"

  # ---------------------------------------------------------------------------
  # Notion
  # ---------------------------------------------------------------------------
  notion:
    name: "Notion"
    description: "Pages, databases, notes from Notion"
    icon: "file-text"
    category: productivity
    status: active

    oauth:
      auth_url: "https://api.notion.com/v1/oauth/authorize"
      token_url: "https://api.notion.com/v1/oauth/token"
      scopes: [] # Notion uses integration tokens

    api:
      base_url: "https://api.notion.com/v1"
      rate_limit:
        requests: 3
        period: second

    sync:
      frequency: hourly
      data_types:
        - pages
        - databases
        - blocks

    bronze_path: "bronze/productivity/notion/"

  # ---------------------------------------------------------------------------
  # Todoist
  # ---------------------------------------------------------------------------
  todoist:
    name: "Todoist"
    description: "Tasks and projects from Todoist"
    icon: "check-square"
    category: productivity
    status: active

    oauth:
      auth_url: "https://todoist.com/oauth/authorize"
      token_url: "https://todoist.com/oauth/access_token"
      scopes:
        - "data:read"
        - "data:read_write"

    api:
      base_url: "https://api.todoist.com/rest/v2"
      rate_limit:
        requests: 1000
        period: day

    sync:
      frequency: hourly
      data_types:
        - tasks
        - projects
        - labels
        - completed_tasks

    bronze_path: "bronze/productivity/todoist/"

# =============================================================================
# FINANCE RIGS
# =============================================================================

finance:
  # ---------------------------------------------------------------------------
  # Plaid (Banking aggregation)
  # ---------------------------------------------------------------------------
  plaid:
    name: "Plaid"
    description: "Bank accounts and transactions"
    icon: "credit-card"
    category: finance
    status: planned

    api:
      base_url: "https://production.plaid.com"
      type: api_key # Plaid uses Link + API key

    sync:
      frequency: daily
      data_types:
        - accounts
        - transactions
        - balances

    bronze_path: "bronze/finance/plaid/"

    # Security
    security:
      encrypt_at_rest: true
      pii_fields:
        - account_number
        - routing_number

# =============================================================================
# SMART HOME RIGS
# =============================================================================

smart_home:
  # ---------------------------------------------------------------------------
  # Philips Hue
  # ---------------------------------------------------------------------------
  philips-hue:
    name: "Philips Hue"
    description: "Smart lighting control"
    icon: "lightbulb"
    category: smart_home
    status: planned

    api:
      base_url: "https://api.meethue.com/v2"
      type: oauth

    sync:
      frequency: realtime
      data_types:
        - lights
        - scenes
        - schedules

    actions:
      - set_light_state
      - activate_scene
      - set_schedule

  # ---------------------------------------------------------------------------
  # Home Assistant
  # ---------------------------------------------------------------------------
  home-assistant:
    name: "Home Assistant"
    description: "Unified smart home control"
    icon: "home"
    category: smart_home
    status: planned

    api:
      base_url: "{user_instance}/api"
      type: long_lived_token

    sync:
      frequency: realtime
      data_types:
        - entities
        - states
        - automations

    actions:
      - call_service
      - set_state
      - trigger_automation

# =============================================================================
# UNIFIED GOOGLE RIG (combines Fit + Workspace + YouTube)
# =============================================================================

unified:
  google:
    name: "Google"
    description: "Unified Google integration (Fit + Workspace + YouTube)"
    icon: "google"
    category: unified
    status: active

    oauth:
      provider: google
      scopes:
        # Google Fit
        - "https://www.googleapis.com/auth/fitness.activity.read"
        - "https://www.googleapis.com/auth/fitness.body.read"
        - "https://www.googleapis.com/auth/fitness.heart_rate.read"
        - "https://www.googleapis.com/auth/fitness.sleep.read"
        # Google Workspace
        - "https://www.googleapis.com/auth/calendar.readonly"
        - "https://www.googleapis.com/auth/calendar.events"
        - "https://www.googleapis.com/auth/drive.readonly"
        - "https://www.googleapis.com/auth/gmail.readonly"
        - "https://www.googleapis.com/auth/tasks.readonly"
        # YouTube
        - "https://www.googleapis.com/auth/youtube.readonly"

    includes:
      - google-fit
      - google-workspace
      - youtube

# =============================================================================
# ENVIRONMENT VARIABLES REQUIRED
# =============================================================================
# GOOGLE_CLIENT_ID - Google OAuth client ID
# GOOGLE_CLIENT_SECRET - Google OAuth client secret
# MICROSOFT_CLIENT_ID - Microsoft OAuth client ID
# MICROSOFT_CLIENT_SECRET - Microsoft OAuth client secret
# NOTION_CLIENT_ID - Notion OAuth client ID
# NOTION_CLIENT_SECRET - Notion OAuth client secret
# TODOIST_CLIENT_ID - Todoist OAuth client ID
# TODOIST_CLIENT_SECRET - Todoist OAuth client secret
# PLAID_CLIENT_ID - Plaid client ID
# PLAID_SECRET - Plaid secret
# =============================================================================
