graph TB
    subgraph TRIGGER["ğŸ¯ Co uruchamia instalacjÄ™ Moda?"]
        T1["ğŸ‘¤ User mÃ³wi:<br/>ChcÄ™ Å›ledziÄ‡ sen"]
        T2["ğŸ¤– AI wykrywa cel<br/>po onboardingu:<br/>primary_goal = health"]
        T3["ğŸ” Gap Detector:<br/>Nie Å›ledzisz snu!<br/>ZaproponowaÄ‡ tracker?"]
    end

    subgraph LOOKUP["ğŸ” Szukanie w katalogu"]
        CAT{"Czy Mod istnieje<br/>w katalogu?"}
        CATALOG["ğŸ“¦ Katalog ModÃ³w<br/>(exo_mod_registry)<br/>7 wbudowanych:<br/>sleep, mood, habit,<br/>energy, focus, task, spending"]
    end

    subgraph INSTALL_YES["âœ… Mod znaleziony"]
        INS["Dodaj wpis do<br/>exo_tenant_mods<br/>(active = true)"]
        READY["Mod gotowy!<br/>UÅ¼ytkownik moÅ¼e<br/>od razu uÅ¼ywaÄ‡"]
    end

    subgraph INSTALL_NO["âŒ Mod NIE istnieje"]
        NO["BÅ‚Ä…d: Mod nie istnieje<br/>w katalogu"]
        FUTURE["ğŸ”® W PRZYSZÅOÅšCI:<br/>System sam zbuduje<br/>custom Mod w 2h<br/>(jeszcze niezaimplementowane)"]
    end

    subgraph USE["ğŸ® Jak user uÅ¼ywa Moda"]
        USE1["ğŸ¤ GÅ‚os:<br/>Zapisz sen 7 godzin"]
        USE2["ğŸ’» Dashboard:<br/>Wykres snu za tydzieÅ„"]
        USE3["âŒš Auto-sync:<br/>Oura Ring â†’ dane snu"]
        USE4["ğŸ’¡ Insighty:<br/>TwÃ³j dÅ‚ug senny: 3h"]
    end

    T1 & T2 & T3 --> LOOKUP
    CATALOG --> CAT
    CAT -->|"TAK"| INS
    INS --> READY
    READY --> USE1 & USE2 & USE3 & USE4
    CAT -->|"NIE"| NO
    NO --> FUTURE

    style TRIGGER fill:#f59e0b,stroke:#d97706,color:#000
    style LOOKUP fill:#3b82f6,stroke:#2563eb,color:#fff
    style INSTALL_YES fill:#22c55e,stroke:#16a34a,color:#fff
    style INSTALL_NO fill:#ef4444,stroke:#dc2626,color:#fff
    style USE fill:#8b5cf6,stroke:#7c3aed,color:#fff
    style CATALOG fill:#6366f1,stroke:#4f46e5,color:#fff
