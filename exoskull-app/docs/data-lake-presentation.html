<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ExoSkull Data Lake - Jak to dziala</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #0a0a0a; color: #e0e0e0; }

  .slide {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 40px 60px;
    border-bottom: 1px solid #222;
    position: relative;
  }
  .slide-num {
    position: absolute;
    top: 20px;
    right: 30px;
    font-size: 14px;
    color: #555;
    font-variant-numeric: tabular-nums;
  }
  h1 { font-size: 48px; margin-bottom: 20px; color: #fff; text-align: center; }
  h2 { font-size: 36px; margin-bottom: 30px; color: #fff; text-align: center; }
  h3 { font-size: 24px; margin-bottom: 16px; color: #ccc; }
  p, li { font-size: 20px; line-height: 1.6; color: #bbb; }
  .subtitle { font-size: 22px; color: #888; margin-bottom: 40px; text-align: center; }

  /* Diagram containers */
  .diagram { width: 100%; max-width: 900px; margin: 30px auto; }
  .diagram svg { width: 100%; height: auto; }

  /* Flow boxes */
  .flow { display: flex; align-items: center; justify-content: center; gap: 16px; flex-wrap: wrap; margin: 30px 0; }
  .box {
    padding: 20px 28px;
    border-radius: 12px;
    font-size: 18px;
    font-weight: 600;
    text-align: center;
    min-width: 160px;
  }
  .box-bronze { background: #7c4a1a; color: #f5c77e; border: 2px solid #c5873a; }
  .box-silver { background: #3a3a4a; color: #c0c0d0; border: 2px solid #8888aa; }
  .box-gold { background: #5c4a0a; color: #ffd700; border: 2px solid #c5a03a; }
  .box-raw { background: #1a3a1a; color: #7ddf7d; border: 2px solid #4a8a4a; }
  .box-api { background: #1a2a4a; color: #7db5ff; border: 2px solid #4a6a9a; }
  .box-dead { background: #3a1a1a; color: #ff7d7d; border: 2px solid #8a4a4a; opacity: 0.6; }
  .box-new { background: #0a3a2a; color: #4dffc3; border: 2px solid #2a8a6a; }

  .arrow { font-size: 28px; color: #555; }
  .arrow-active { color: #4dffc3; }
  .arrow-dead { color: #ff4444; text-decoration: line-through; }

  /* Grid layouts */
  .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; width: 100%; max-width: 900px; }
  .grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; width: 100%; max-width: 900px; }

  .card {
    background: #151515;
    border: 1px solid #2a2a2a;
    border-radius: 12px;
    padding: 24px;
  }
  .card h3 { margin-bottom: 12px; }
  .card ul { padding-left: 20px; }
  .card li { font-size: 16px; margin-bottom: 6px; }

  .status-ok { color: #4dffc3; }
  .status-bad { color: #ff4444; }
  .status-new { color: #ffd700; }
  .status-meh { color: #ff9944; }

  .big-emoji { font-size: 64px; margin-bottom: 16px; }
  .highlight { color: #4dffc3; font-weight: 700; }
  .bad { color: #ff4444; font-weight: 700; }
  .warn { color: #ff9944; }

  /* Comparison table */
  table { border-collapse: collapse; width: 100%; max-width: 900px; margin: 20px 0; }
  th, td { padding: 14px 18px; text-align: left; border-bottom: 1px solid #222; font-size: 17px; }
  th { color: #888; font-weight: 600; font-size: 14px; text-transform: uppercase; letter-spacing: 1px; }
  tr:hover { background: #151515; }

  .tag {
    display: inline-block;
    padding: 3px 10px;
    border-radius: 6px;
    font-size: 13px;
    font-weight: 600;
  }
  .tag-ok { background: #0a3a2a; color: #4dffc3; }
  .tag-bad { background: #3a1a1a; color: #ff7d7d; }
  .tag-new { background: #1a2a4a; color: #7db5ff; }
  .tag-dead { background: #2a2a2a; color: #666; }

  /* Timeline */
  .timeline {
    position: relative;
    padding-left: 40px;
    max-width: 700px;
    margin: 20px auto;
  }
  .timeline::before {
    content: '';
    position: absolute;
    left: 14px;
    top: 0;
    bottom: 0;
    width: 2px;
    background: #333;
  }
  .timeline-item {
    position: relative;
    margin-bottom: 24px;
    padding-left: 20px;
  }
  .timeline-item::before {
    content: '';
    position: absolute;
    left: -30px;
    top: 8px;
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: #4dffc3;
    border: 2px solid #0a3a2a;
  }
  .timeline-item.dead::before { background: #ff4444; }

  /* Nav */
  nav {
    position: fixed;
    bottom: 20px;
    right: 20px;
    display: flex;
    gap: 8px;
    z-index: 100;
  }
  nav a {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background: #1a1a1a;
    border: 1px solid #333;
    border-radius: 8px;
    color: #888;
    text-decoration: none;
    font-size: 18px;
  }
  nav a:hover { background: #2a2a2a; color: #fff; }
</style>
</head>
<body>

<!-- ===================== SLIDE 1: Title ===================== -->
<div class="slide" id="s1">
  <span class="slide-num">1 / 8</span>
  <div class="big-emoji">&#x1F9E0;</div>
  <h1>ExoSkull Data Lake</h1>
  <p class="subtitle">Co to jest, po co, i dlaczego nie dzialalo</p>
</div>

<!-- ===================== SLIDE 2: What is a Data Lake ===================== -->
<div class="slide" id="s2">
  <span class="slide-num">2 / 8</span>
  <h2>Co to jest Data Lake?</h2>
  <p class="subtitle">3 warstwy danych - od surowych do gotowych</p>

  <svg viewBox="0 0 900 340" xmlns="http://www.w3.org/2000/svg" style="max-width:900px">
    <!-- Bronze -->
    <rect x="20" y="20" width="260" height="300" rx="16" fill="#1a1208" stroke="#c5873a" stroke-width="2"/>
    <text x="150" y="60" text-anchor="middle" fill="#f5c77e" font-size="22" font-weight="700">BRONZE</text>
    <text x="150" y="88" text-anchor="middle" fill="#c5873a" font-size="14">Surowe dane</text>
    <line x1="40" y1="100" x2="260" y2="100" stroke="#2a1a0a" stroke-width="1"/>
    <text x="150" y="130" text-anchor="middle" fill="#a08050" font-size="16">Cloudflare R2</text>
    <text x="150" y="156" text-anchor="middle" fill="#a08050" font-size="16">Parquet files</text>
    <text x="150" y="190" text-anchor="middle" fill="#887050" font-size="14">Kopia 1:1 z Supabase</text>
    <text x="150" y="212" text-anchor="middle" fill="#887050" font-size="14">Backup, nigdy usuwany</text>
    <text x="150" y="250" text-anchor="middle" fill="#665030" font-size="13">conversations, messages</text>
    <text x="150" y="272" text-anchor="middle" fill="#665030" font-size="13">voice_calls, sms_logs</text>

    <!-- Arrow 1 -->
    <polygon points="300,160 320,145 320,175" fill="#555"/>

    <!-- Silver -->
    <rect x="330" y="20" width="240" height="300" rx="16" fill="#12121a" stroke="#8888aa" stroke-width="2"/>
    <text x="450" y="60" text-anchor="middle" fill="#c0c0d0" font-size="22" font-weight="700">SILVER</text>
    <text x="450" y="88" text-anchor="middle" fill="#8888aa" font-size="14">Oczyszczone dane</text>
    <line x1="350" y1="100" x2="550" y2="100" stroke="#1a1a2a" stroke-width="1"/>
    <text x="450" y="130" text-anchor="middle" fill="#9999bb" font-size="16">Supabase Postgres</text>
    <text x="450" y="156" text-anchor="middle" fill="#9999bb" font-size="16">exo_silver_* tabele</text>
    <text x="450" y="196" text-anchor="middle" fill="#777799" font-size="14">Deduplikacja</text>
    <text x="450" y="218" text-anchor="middle" fill="#777799" font-size="14">Walidacja schematu</text>
    <text x="450" y="240" text-anchor="middle" fill="#777799" font-size="14">Normalizacja timestamps</text>
    <text x="450" y="262" text-anchor="middle" fill="#777799" font-size="14">JSON parsing</text>

    <!-- Arrow 2 -->
    <polygon points="590,160 610,145 610,175" fill="#555"/>

    <!-- Gold -->
    <rect x="620" y="20" width="260" height="300" rx="16" fill="#1a1808" stroke="#c5a03a" stroke-width="2"/>
    <text x="750" y="60" text-anchor="middle" fill="#ffd700" font-size="22" font-weight="700">GOLD</text>
    <text x="750" y="88" text-anchor="middle" fill="#c5a03a" font-size="14">Gotowe agregaty</text>
    <line x1="640" y1="100" x2="860" y2="100" stroke="#2a2008" stroke-width="1"/>
    <text x="750" y="130" text-anchor="middle" fill="#d4b040" font-size="16">Materialized Views</text>
    <text x="750" y="156" text-anchor="middle" fill="#d4b040" font-size="16">&lt;100ms odpowiedzi</text>
    <text x="750" y="196" text-anchor="middle" fill="#a09030" font-size="14">Dzienne podsumowania</text>
    <text x="750" y="218" text-anchor="middle" fill="#a09030" font-size="14">Tygodniowe trendy</text>
    <text x="750" y="240" text-anchor="middle" fill="#a09030" font-size="14">Miesieczne raporty</text>
    <text x="750" y="262" text-anchor="middle" fill="#a09030" font-size="14">Statystyki wiadomosci</text>
  </svg>

  <p style="max-width:700px;text-align:center;margin-top:20px;">
    Idea: surowe dane <span class="warn">Bronze</span> sa czyszczone do <span style="color:#c0c0d0">Silver</span>,
    a potem agregowane do <span class="status-new">Gold</span> — gotowych do wyswietlenia na dashboardzie w &lt;100ms.
  </p>
</div>

<!-- ===================== SLIDE 3: What was broken ===================== -->
<div class="slide" id="s3">
  <span class="slide-num">3 / 8</span>
  <h2>Co bylo zle?</h2>
  <p class="subtitle">Caly pipeline zalezny od R2 — i prawdopodobnie nie dzialal</p>

  <svg viewBox="0 0 900 280" xmlns="http://www.w3.org/2000/svg" style="max-width:900px">
    <!-- Supabase raw -->
    <rect x="20" y="90" width="140" height="80" rx="10" fill="#0a2a0a" stroke="#4a8a4a" stroke-width="2"/>
    <text x="90" y="125" text-anchor="middle" fill="#7ddf7d" font-size="15" font-weight="600">Supabase</text>
    <text x="90" y="147" text-anchor="middle" fill="#5aaa5a" font-size="13">surowe tabele</text>

    <!-- Arrow to Bronze -->
    <line x1="160" y1="130" x2="210" y2="130" stroke="#555" stroke-width="2"/>
    <polygon points="210,125 220,130 210,135" fill="#555"/>

    <!-- Bronze R2 -->
    <rect x="220" y="80" width="140" height="100" rx="10" fill="#1a1208" stroke="#c5873a" stroke-width="2"/>
    <text x="290" y="115" text-anchor="middle" fill="#f5c77e" font-size="15" font-weight="600">Bronze (R2)</text>
    <text x="290" y="137" text-anchor="middle" fill="#c5873a" font-size="13">Parquet files</text>
    <text x="290" y="157" text-anchor="middle" fill="#885530" font-size="12">Cloudflare</text>

    <!-- X mark on R2 -->
    <circle cx="290" cy="40" r="24" fill="#3a0a0a" stroke="#ff4444" stroke-width="2"/>
    <line x1="278" y1="28" x2="302" y2="52" stroke="#ff4444" stroke-width="3"/>
    <line x1="302" y1="28" x2="278" y2="52" stroke="#ff4444" stroke-width="3"/>
    <text x="290" y="10" text-anchor="middle" fill="#ff4444" font-size="12" font-weight="700">BRAK CREDENTIALS?</text>

    <!-- Arrow to Silver (blocked) -->
    <line x1="360" y1="130" x2="430" y2="130" stroke="#ff4444" stroke-width="2" stroke-dasharray="8,4"/>
    <text x="395" y="118" text-anchor="middle" fill="#ff4444" font-size="20">&#x2717;</text>

    <!-- Silver -->
    <rect x="440" y="90" width="140" height="80" rx="10" fill="#12121a" stroke="#555577" stroke-width="2" opacity="0.5"/>
    <text x="510" y="125" text-anchor="middle" fill="#888899" font-size="15" font-weight="600">Silver</text>
    <text x="510" y="147" text-anchor="middle" fill="#666677" font-size="13">PUSTE tabele</text>

    <!-- Arrow to Gold (blocked) -->
    <line x1="580" y1="130" x2="650" y2="130" stroke="#ff4444" stroke-width="2" stroke-dasharray="8,4"/>
    <text x="615" y="118" text-anchor="middle" fill="#ff4444" font-size="20">&#x2717;</text>

    <!-- Gold -->
    <rect x="660" y="90" width="140" height="80" rx="10" fill="#1a1808" stroke="#887730" stroke-width="2" opacity="0.5"/>
    <text x="730" y="125" text-anchor="middle" fill="#bba040" font-size="15" font-weight="600">Gold</text>
    <text x="730" y="147" text-anchor="middle" fill="#887730" font-size="13">PUSTE views</text>

    <!-- Dashboard below, querying raw -->
    <rect x="580" y="210" width="220" height="60" rx="10" fill="#1a1a2a" stroke="#4a6a9a" stroke-width="2"/>
    <text x="690" y="238" text-anchor="middle" fill="#7db5ff" font-size="14" font-weight="600">Dashboard</text>
    <text x="690" y="256" text-anchor="middle" fill="#5588bb" font-size="12">query'uje SUROWE tabele!</text>

    <!-- Dashboard arrow back to Supabase -->
    <path d="M 580 245 Q 300 280 160 145" fill="none" stroke="#ff9944" stroke-width="2" stroke-dasharray="6,3"/>
    <text x="350" y="260" text-anchor="middle" fill="#ff9944" font-size="13">pomija caly Data Lake!</text>
  </svg>

  <div class="grid-2" style="margin-top: 30px;">
    <div class="card">
      <h3 class="status-bad">Problem #1: R2 blocker</h3>
      <ul>
        <li>Silver ETL czyta z R2 Parquet</li>
        <li>Bez R2 credentials = <span class="bad">HTTP 503</span></li>
        <li>Silver tabele puste &rarr; Gold views puste</li>
        <li>Caly pipeline martwy</li>
      </ul>
    </div>
    <div class="card">
      <h3 class="status-bad">Problem #2: Brak konsumentow</h3>
      <ul>
        <li>8 gotowych query functions &mdash; <span class="bad">NIGDY nie wywolane</span></li>
        <li>Dashboard query'uje surowe tabele</li>
        <li>Brak API route dla analytics</li>
        <li>DuckDB client = martwy stub</li>
      </ul>
    </div>
  </div>
</div>

<!-- ===================== SLIDE 4: The fix ===================== -->
<div class="slide" id="s4">
  <span class="slide-num">4 / 8</span>
  <h2>Co naprawilismy</h2>
  <p class="subtitle">Direct mode — Silver czyta z Supabase, nie z R2</p>

  <svg viewBox="0 0 900 300" xmlns="http://www.w3.org/2000/svg" style="max-width:900px">
    <!-- Supabase raw -->
    <rect x="20" y="100" width="160" height="100" rx="10" fill="#0a2a0a" stroke="#4a8a4a" stroke-width="2"/>
    <text x="100" y="130" text-anchor="middle" fill="#7ddf7d" font-size="16" font-weight="700">Supabase</text>
    <text x="100" y="152" text-anchor="middle" fill="#5aaa5a" font-size="13">exo_conversations</text>
    <text x="100" y="172" text-anchor="middle" fill="#5aaa5a" font-size="13">exo_messages</text>

    <!-- OLD path through R2 (dimmed) -->
    <path d="M 180 120 Q 260 40 340 120" fill="none" stroke="#333" stroke-width="1.5" stroke-dasharray="4,4"/>
    <rect x="240" y="20" width="100" height="40" rx="8" fill="#1a1208" stroke="#443322" stroke-width="1" opacity="0.4"/>
    <text x="290" y="46" text-anchor="middle" fill="#665530" font-size="12">Bronze R2</text>
    <text x="290" y="12" text-anchor="middle" fill="#665530" font-size="10">(opcjonalny)</text>

    <!-- NEW direct arrow -->
    <line x1="180" y1="150" x2="340" y2="150" stroke="#4dffc3" stroke-width="3"/>
    <polygon points="340,143 355,150 340,157" fill="#4dffc3"/>
    <rect x="220" y="158" width="80" height="22" rx="6" fill="#0a3a2a"/>
    <text x="260" y="174" text-anchor="middle" fill="#4dffc3" font-size="12" font-weight="700">DIRECT!</text>

    <!-- Silver -->
    <rect x="360" y="100" width="160" height="100" rx="10" fill="#12121a" stroke="#8888aa" stroke-width="2.5"/>
    <text x="440" y="130" text-anchor="middle" fill="#c0c0d0" font-size="16" font-weight="700">Silver</text>
    <text x="440" y="152" text-anchor="middle" fill="#9999bb" font-size="13">exo_silver_*</text>
    <text x="440" y="172" text-anchor="middle" fill="#9999bb" font-size="13">oczyszczone dane</text>

    <!-- Arrow to Gold -->
    <line x1="520" y1="150" x2="600" y2="150" stroke="#4dffc3" stroke-width="3"/>
    <polygon points="600,143 615,150 600,157" fill="#4dffc3"/>

    <!-- Gold -->
    <rect x="620" y="100" width="160" height="100" rx="10" fill="#1a1808" stroke="#c5a03a" stroke-width="2.5"/>
    <text x="700" y="130" text-anchor="middle" fill="#ffd700" font-size="16" font-weight="700">Gold</text>
    <text x="700" y="152" text-anchor="middle" fill="#d4b040" font-size="13">exo_gold_*</text>
    <text x="700" y="172" text-anchor="middle" fill="#d4b040" font-size="13">mat. views</text>

    <!-- API route -->
    <line x1="700" y1="200" x2="700" y2="250" stroke="#4dffc3" stroke-width="2"/>
    <polygon points="693,250 700,262 707,250" fill="#4dffc3"/>
    <rect x="610" y="265" width="180" height="30" rx="8" fill="#0a2a1a" stroke="#2a8a6a" stroke-width="1.5"/>
    <text x="700" y="285" text-anchor="middle" fill="#4dffc3" font-size="13" font-weight="600">/api/analytics/summary</text>
    <rect x="570" y="248" width="50" height="18" rx="4" fill="#0a3a2a"/>
    <text x="595" y="261" text-anchor="middle" fill="#4dffc3" font-size="11" font-weight="700">NEW!</text>
  </svg>

  <div class="grid-3" style="margin-top:20px;">
    <div class="card">
      <h3 style="color:#4dffc3;">Direct Silver ETL</h3>
      <p style="font-size:15px;">Supabase &rarr; Silver<br>bez R2 dependency</p>
    </div>
    <div class="card">
      <h3 style="color:#ffd700;">Gold Refresh</h3>
      <p style="font-size:15px;">Silver &rarr; Materialized Views<br>codziennie o 04:00 UTC</p>
    </div>
    <div class="card">
      <h3 style="color:#7db5ff;">Analytics API</h3>
      <p style="font-size:15px;">/api/analytics/summary<br>daily/weekly/monthly/insights</p>
    </div>
  </div>
</div>

<!-- ===================== SLIDE 5: Before vs After ===================== -->
<div class="slide" id="s5">
  <span class="slide-num">5 / 8</span>
  <h2>Przed vs Po</h2>

  <table>
    <tr>
      <th style="width:30%">Element</th>
      <th style="width:35%">Przed</th>
      <th style="width:35%">Po</th>
    </tr>
    <tr>
      <td>Silver ETL</td>
      <td><span class="tag tag-bad">Wymaga R2</span> failuje gdy brak creds</td>
      <td><span class="tag tag-ok">Direct mode</span> czyta z Supabase bezposrednio</td>
    </tr>
    <tr>
      <td>Gold Views</td>
      <td><span class="tag tag-bad">Puste</span> bo Silver pusty</td>
      <td><span class="tag tag-ok">Napelnione</span> codziennie z Silver</td>
    </tr>
    <tr>
      <td>Analytics API</td>
      <td><span class="tag tag-bad">Nie istnieje</span></td>
      <td><span class="tag tag-new">/api/analytics/summary</span> daily/weekly/monthly</td>
    </tr>
    <tr>
      <td>Query functions</td>
      <td><span class="tag tag-bad">8 funkcji, 0 uzyc</span></td>
      <td><span class="tag tag-ok">Uzywane</span> przez analytics API</td>
    </tr>
    <tr>
      <td>DuckDB client</td>
      <td><span class="tag tag-dead">Martwy stub</span> ~400 linii</td>
      <td><span class="tag tag-ok">Usuniety</span> zero martwego kodu</td>
    </tr>
    <tr>
      <td>R2 Bronze</td>
      <td><span class="tag tag-dead">Blokuje</span> caly pipeline</td>
      <td><span class="tag tag-ok">Opcjonalny</span> automatyczny fallback</td>
    </tr>
    <tr>
      <td>Dashboard</td>
      <td>Query surowe tabele (wolny)</td>
      <td>Moze uzywac Gold views (&lt;100ms)</td>
    </tr>
  </table>
</div>

<!-- ===================== SLIDE 6: Data flow diagram ===================== -->
<div class="slide" id="s6">
  <span class="slide-num">6 / 8</span>
  <h2>Pelny schemat przeplywu danych</h2>

  <svg viewBox="0 0 900 480" xmlns="http://www.w3.org/2000/svg" style="max-width:900px">
    <!-- Top: Data Sources -->
    <text x="450" y="25" text-anchor="middle" fill="#888" font-size="14" font-weight="600">ZRODLA DANYCH</text>

    <rect x="50" y="40" width="130" height="50" rx="8" fill="#0a2a0a" stroke="#4a8a4a" stroke-width="1.5"/>
    <text x="115" y="70" text-anchor="middle" fill="#7ddf7d" font-size="13">Chat / Voice</text>

    <rect x="200" y="40" width="130" height="50" rx="8" fill="#0a2a0a" stroke="#4a8a4a" stroke-width="1.5"/>
    <text x="265" y="70" text-anchor="middle" fill="#7ddf7d" font-size="13">SMS / Telegram</text>

    <rect x="350" y="40" width="130" height="50" rx="8" fill="#0a2a0a" stroke="#4a8a4a" stroke-width="1.5"/>
    <text x="415" y="70" text-anchor="middle" fill="#7ddf7d" font-size="13">Slack / Discord</text>

    <rect x="500" y="40" width="130" height="50" rx="8" fill="#0a2a0a" stroke="#4a8a4a" stroke-width="1.5"/>
    <text x="565" y="70" text-anchor="middle" fill="#7ddf7d" font-size="13">API / Webhook</text>

    <!-- Arrows down to Gateway -->
    <line x1="115" y1="90" x2="400" y2="120" stroke="#3a6a3a" stroke-width="1"/>
    <line x1="265" y1="90" x2="400" y2="120" stroke="#3a6a3a" stroke-width="1"/>
    <line x1="415" y1="90" x2="400" y2="120" stroke="#3a6a3a" stroke-width="1"/>
    <line x1="565" y1="90" x2="400" y2="120" stroke="#3a6a3a" stroke-width="1"/>

    <!-- Gateway -->
    <rect x="300" y="120" width="200" height="50" rx="8" fill="#151525" stroke="#6666aa" stroke-width="2"/>
    <text x="400" y="150" text-anchor="middle" fill="#aaaadd" font-size="15" font-weight="700">Unified Gateway</text>

    <!-- Arrow to Supabase -->
    <line x1="400" y1="170" x2="400" y2="200" stroke="#6666aa" stroke-width="2"/>
    <polygon points="394,198 400,210 406,198" fill="#6666aa"/>

    <!-- Supabase Raw -->
    <rect x="280" y="210" width="240" height="60" rx="10" fill="#0a2a0a" stroke="#4a8a4a" stroke-width="2"/>
    <text x="400" y="237" text-anchor="middle" fill="#7ddf7d" font-size="16" font-weight="700">Supabase (surowe tabele)</text>
    <text x="400" y="258" text-anchor="middle" fill="#5aaa5a" font-size="12">exo_conversations, exo_messages, ...</text>

    <!-- Two paths from Supabase -->

    <!-- Path 1: Bronze (dimmed, optional) -->
    <line x1="340" y1="270" x2="140" y2="310" stroke="#443322" stroke-width="1" stroke-dasharray="5,5"/>
    <rect x="50" y="310" width="180" height="50" rx="8" fill="#1a1208" stroke="#443322" stroke-width="1" opacity="0.5"/>
    <text x="140" y="335" text-anchor="middle" fill="#887755" font-size="13">Bronze R2 (opcjonalny)</text>
    <text x="140" y="350" text-anchor="middle" fill="#665530" font-size="11">backup Parquet</text>

    <!-- Path 2: Direct Silver (main path) -->
    <line x1="400" y1="270" x2="400" y2="310" stroke="#4dffc3" stroke-width="3"/>
    <polygon points="394,308 400,320 406,308" fill="#4dffc3"/>
    <text x="440" y="295" fill="#4dffc3" font-size="12" font-weight="700">DIRECT ETL</text>

    <!-- Silver -->
    <rect x="300" y="320" width="200" height="50" rx="10" fill="#12121a" stroke="#8888aa" stroke-width="2"/>
    <text x="400" y="350" text-anchor="middle" fill="#c0c0d0" font-size="15" font-weight="700">Silver (oczyszczone)</text>

    <!-- Arrow to Gold -->
    <line x1="400" y1="370" x2="400" y2="400" stroke="#4dffc3" stroke-width="3"/>
    <polygon points="394,398 400,410 406,398" fill="#4dffc3"/>
    <text x="440" y="390" fill="#d4b040" font-size="12" font-weight="600">CRON 04:00</text>

    <!-- Gold -->
    <rect x="300" y="410" width="200" height="50" rx="10" fill="#1a1808" stroke="#c5a03a" stroke-width="2"/>
    <text x="400" y="440" text-anchor="middle" fill="#ffd700" font-size="15" font-weight="700">Gold (agregaty)</text>

    <!-- Consumers -->
    <!-- API -->
    <line x1="500" y1="435" x2="620" y2="435" stroke="#4dffc3" stroke-width="2"/>
    <polygon points="618,429 630,435 618,441" fill="#4dffc3"/>
    <rect x="630" y="415" width="200" height="40" rx="8" fill="#0a2a1a" stroke="#2a8a6a" stroke-width="1.5"/>
    <text x="730" y="440" text-anchor="middle" fill="#4dffc3" font-size="13" font-weight="600">/api/analytics/summary</text>

    <!-- Admin -->
    <line x1="500" y1="430" x2="620" y2="380" stroke="#7db5ff" stroke-width="1.5"/>
    <rect x="630" y="360" width="200" height="40" rx="8" fill="#0a1a2a" stroke="#3a5a8a" stroke-width="1.5"/>
    <text x="730" y="385" text-anchor="middle" fill="#7db5ff" font-size="13">/admin/data-pipeline</text>

    <!-- CRON schedule labels -->
    <rect x="660" y="300" width="180" height="50" rx="8" fill="#111" stroke="#333" stroke-width="1"/>
    <text x="750" y="318" text-anchor="middle" fill="#888" font-size="12" font-weight="600">CRON Schedule:</text>
    <text x="750" y="336" text-anchor="middle" fill="#666" font-size="11">Silver: codziennie 02:00 UTC</text>
    <text x="750" y="348" text-anchor="middle" fill="#666" font-size="11">Gold: codziennie 04:00 UTC</text>
  </svg>
</div>

<!-- ===================== SLIDE 7: Gold Views detail ===================== -->
<div class="slide" id="s7">
  <span class="slide-num">7 / 8</span>
  <h2>Co daja Gold Views?</h2>
  <p class="subtitle">4 materialized views = gotowe dane do dashboardu</p>

  <div class="grid-2">
    <div class="card" style="border-color:#c5a03a;">
      <h3 style="color:#ffd700;">exo_gold_daily_summary</h3>
      <ul>
        <li>Ile rozmow dziennie</li>
        <li>Sredni czas rozmowy</li>
        <li>Rozklad kanalow (voice/sms/web/api)</li>
        <li><strong>Okres:</strong> 30 dni wstecz</li>
      </ul>
    </div>
    <div class="card" style="border-color:#c5a03a;">
      <h3 style="color:#ffd700;">exo_gold_weekly_summary</h3>
      <ul>
        <li>Ile rozmow tygodniowo</li>
        <li>Ile aktywnych dni</li>
        <li>Trendy kanalom</li>
        <li><strong>Okres:</strong> 12 tygodni wstecz</li>
      </ul>
    </div>
    <div class="card" style="border-color:#c5a03a;">
      <h3 style="color:#ffd700;">exo_gold_monthly_summary</h3>
      <ul>
        <li>Miesieczne agregaty</li>
        <li>Aktywne dni w miesiacu</li>
        <li>Calkowity czas interakcji</li>
        <li><strong>Okres:</strong> 12 miesiecy wstecz</li>
      </ul>
    </div>
    <div class="card" style="border-color:#c5a03a;">
      <h3 style="color:#ffd700;">exo_gold_messages_daily</h3>
      <ul>
        <li>Ile wiadomosci dziennie</li>
        <li>Podzial: user / assistant / system</li>
        <li>Sredni czas odpowiedzi</li>
        <li>Unikalne konwersacje</li>
      </ul>
    </div>
  </div>

  <div style="margin-top:30px; max-width:700px; text-align:center;">
    <p>Zapytanie do Gold view: <span class="highlight">&lt;100ms</span></p>
    <p>Zapytanie do surowej tabeli: <span class="bad">500ms - 3s</span> (pelne skany)</p>
  </div>
</div>

<!-- ===================== SLIDE 8: API Usage ===================== -->
<div class="slide" id="s8">
  <span class="slide-num">8 / 8</span>
  <h2>Jak uzywac Analytics API</h2>

  <div style="max-width:750px; width:100%;">
    <div class="card" style="margin-bottom:20px; border-color:#2a8a6a;">
      <h3 style="color:#4dffc3;">GET /api/analytics/summary?period=daily&days=30</h3>
      <p style="font-size:15px; color:#888;">Dzienne podsumowania + statystyki wiadomosci (30 dni)</p>
    </div>
    <div class="card" style="margin-bottom:20px; border-color:#2a8a6a;">
      <h3 style="color:#4dffc3;">GET /api/analytics/summary?period=weekly&days=84</h3>
      <p style="font-size:15px; color:#888;">Tygodniowe trendy (12 tygodni)</p>
    </div>
    <div class="card" style="margin-bottom:20px; border-color:#2a8a6a;">
      <h3 style="color:#4dffc3;">GET /api/analytics/summary?period=monthly&days=365</h3>
      <p style="font-size:15px; color:#888;">Miesieczne raporty (12 miesiecy)</p>
    </div>
    <div class="card" style="border-color:#2a8a6a;">
      <h3 style="color:#4dffc3;">GET /api/analytics/summary?period=insights</h3>
      <p style="font-size:15px; color:#888;">Conversation insights + porownanie z poprzednim tygodniem</p>
    </div>
  </div>

  <div style="margin-top:40px; text-align:center;">
    <p style="font-size:22px; color:#ffd700; font-weight:700;">Pipeline gotowy. Dane plyna. Gold views konsumowane.</p>
    <p style="font-size:16px; color:#666; margin-top:10px;">Nastepny krok: Dashboard widget z wykresami trendow</p>
  </div>
</div>

<!-- Navigation -->
<nav>
  <a href="#s1">1</a><a href="#s2">2</a><a href="#s3">3</a><a href="#s4">4</a>
  <a href="#s5">5</a><a href="#s6">6</a><a href="#s7">7</a><a href="#s8">8</a>
</nav>

</body>
</html>
